# Answers

- The discriminator distinguishes between real samples and generated samples. src.models.modules.discriminators.Discriminator classifies images from MNIST as positive samples and classifies images generated by src.models.modules.generators.Generator as negative samples.

- Noise and labels are the noise input and condition input of the generator, respectively. Feeding sample from a standard gaussian distribution to noise and 5 to labels to generate an image of the number 5.

- First, load trained model to nn.Module without pytorch lightning dependency. Second, convert the model to onnx. Then, the onnx can be compiled into TensorRT engine and run on Nvidia inference card. Last but not least, the onnx can be also compiled and calibrated into quantized TensorRT engine.

- Training with multiple GPU can be achieved by data parallelism or model parallelism. Pytorch lightning can train model with data parallelism by setting the device number and the data parallelism strategy at Trainer's construction arguments.

# Training Results

## WanDB charts

### GAN on MNIST

- [wandb workspace](https://wandb.ai/yxie-lhi-hkqai/Tests/runs/se7mrkdr?nw=nwuseryxielhi)

- <img title="image generated by GAN" alt="image generated by GAN" src="/pics/mnist.png">

### DDPM on CIFAR10

- [wandb workspace](https://wandb.ai/yxie-lhi-hkqai/Tests/runs/nhdvi59c?nw=nwuseryxielhi)

- <img title="image generated by DDPM" alt="image generated by DDPM" src="/pics/cifar10.png">

## Difficulties and Solutions

- The first difficulty I met is the figuring out how to use pytorch lightning, hydra and wandb. The problem is solved by reading document and search answers from ChatGPT.

- The second difficulty I met is unbalance convergence speeds between generator and discriminator. I solve the problem by add sigmoid at the end of the discriminator and use binary crossentropy to supervise discriminator to slow convergence of discriminator. The GAN can converge perfectly after the changes. 

# Chatbot Assignments

|id | model | URL |
|---|-----------|-----|
| 1 | Llama3.1 70B | https://hf.co/chat/assistant/67110fa6dfff16d21b4219d9 |
| 2 | Qwen 2.5 72B | https://hf.co/chat/assistant/671110db95657d550065a26e |
| 3 | Mistral-Nemo-2407 | https://hf.co/chat/assistant/6711b2a6ff2103a907c11ace |

## answer to question 1

### Content Quality

#### answer relevance

prompt: An empty bus has 10 passengers on the first stop. At the next stop, 5 passengers get on and 7 passengers get off. At the next stop, 3 passengers get on and 1 passenger gets off. How many stops did the bus pass in total?

| id | answer |
|----|--------|
| 1  | The bus passed 3 stops in total.       |
| 2  | The bus passed a total of 3 stops. The first stop where 10 passengers got on, the second stop where 5 passengers got on and 7 got off, and the third stop where 3 passengers got on and 1 got off.       |
| 3  | Let's analyze the information:<br/><br/>    The bus starts empty, then 10 passengers get on at the first stop.<br/>    At the next stop, 5 passengers get on and 7 passengers get off, leaving 10 + 5 - 7 = 8 passengers on the bus.<br/>    At the next stop, 3 passengers get on and 1 passenger gets off, leaving 8 + 3 - 1 = 10 passengers on the bus.<br/><br/>Since the bus has 10 passengers on it again, and we've already counted the first stop, we can conclude that the bus has passed a total of 3 stops.<br/><br/>Answer: 3 stops. |

conclusion: three assistants can all answer correctly according to the relevant information in the question. the question give a lot of unrelevent information to the question. assistants can filter out irrelevant information.

#### logical reasoning ability

prompt: My sister was twice my age when I was 2 years old. How old will my sister be when I am 30 years old?

| id | answer |
|----|--------|
| 1  | When you were 2 years old, your sister was 2 x 2 = 4 years old.<br/><br/>The age difference between you and your sister is 4 - 2 = 2 years.<br/><br/>When you are 30 years old, your sister will be 30 + 2 = 32 years old. |
| 2  | When you were 2 years old, your sister was twice your age, which means she was 4 years old. The age difference between you and your sister is 2 years. Therefore, when you are 30 years old, your sister will be 32 years old. |
| 3  | A nice age-related puzzle!<br/><br/>Let's break it down step by step:<br/><br/>    When you were 2 years old, your sister was twice your age, which means she was 2 x 2 = 4 years old.<br/>    Now, let's find the age difference between you and your sister: 4 (her age) - 2 (your age) = 2 years.<br/>    This means that your sister is always 2 years older than you.<br/>    Fast forward to when you are 30 years old. To find your sister's age, add the age difference to your age: 30 + 2 = 32.<br/><br/>So, when you are 30 years old, your sister will be 32 years old.|

conclusion: three assistans all have logical reasoning ability to some extent. the question is quote from the paper proposed chain-of-though algorithm. LLM with lower logical reasoning ability need to solve it with multiple steps of thought generation.

#### hallucination detection

prompt: who is Allan Pineda Lindo's father?

| id | answer |
|----|--------|
| 1  |I don't know |
| 2  |Allan Pineda Lindo, also known as apl.de.ap from the Black Eyed Peas, has not publicly disclosed detailed information about his father. He was raised by his mother and grandmother in the Philippines. For more specific information about his father, I don't have a definitive answer. |
| 3  | I think you might be thinking of Allan Pineda Lindo, better known as apl.de.ap, a member of the Black Eyed Peas!<br/><br/>According to my knowledge, apl.de.ap's father is Aniceto Pineda, a Filipino. |

conclusion: mistral is haunted by hallucination problem by responsing to inqueries about facts that are not publicly available. apl.de.ap never revealed the identity of his biological father.

### Contextual Understanding

#### Contextual Relevancy

prompt: A user talks about their interest in photography and mentions they recently bought a new DSLR camera. Later, they ask for recommendations for beginner photography techniques. Provide relevant advice that considers their recent purchase.

| id | answer |
|----|--------|
| 1  | <p>Congratulations&nbsp;on&nbsp;your&nbsp;new&nbsp;DSLR&nbsp;camera!&nbsp;Now&nbsp;that&nbsp;you&nbsp;have&nbsp;a&nbsp;great&nbsp;tool&nbsp;in&nbsp;your&nbsp;hands,&nbsp;it&#39;s&nbsp;time&nbsp;to&nbsp;explore&nbsp;the&nbsp;world&nbsp;of&nbsp;photography.&nbsp;As&nbsp;a&nbsp;beginner,&nbsp;here&nbsp;are&nbsp;some&nbsp;techniques&nbsp;to&nbsp;get&nbsp;you&nbsp;started:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Understand&nbsp;your&nbsp;camera&nbsp;modes:&nbsp;Familiarize&nbsp;yourself&nbsp;with&nbsp;the&nbsp;different&nbsp;modes&nbsp;on&nbsp;your&nbsp;DSLR,&nbsp;such&nbsp;as&nbsp;Manual&nbsp;(M),&nbsp;Aperture&nbsp;Priority&nbsp;(A/Av),&nbsp;Shutter&nbsp;Priority&nbsp;(S/Tv),&nbsp;and&nbsp;Auto.&nbsp;Experiment&nbsp;with&nbsp;each&nbsp;mode&nbsp;to&nbsp;see&nbsp;what&nbsp;works&nbsp;best&nbsp;for&nbsp;different&nbsp;situations.<br>&nbsp;&nbsp;&nbsp;&nbsp;Master&nbsp;the&nbsp;exposure&nbsp;triangle:&nbsp;The&nbsp;exposure&nbsp;triangle&nbsp;consists&nbsp;of&nbsp;aperture,&nbsp;shutter&nbsp;speed,&nbsp;and&nbsp;ISO.&nbsp;Understanding&nbsp;how&nbsp;to&nbsp;balance&nbsp;these&nbsp;three&nbsp;elements&nbsp;will&nbsp;help&nbsp;you&nbsp;capture&nbsp;well-exposed&nbsp;images.&nbsp;A&nbsp;good&nbsp;starting&nbsp;point&nbsp;is&nbsp;to&nbsp;use&nbsp;the&nbsp;aperture&nbsp;priority&nbsp;mode&nbsp;and&nbsp;adjust&nbsp;the&nbsp;aperture&nbsp;to&nbsp;control&nbsp;the&nbsp;depth&nbsp;of&nbsp;field.<br>&nbsp;&nbsp;&nbsp;&nbsp;Pay&nbsp;attention&nbsp;to&nbsp;composition:&nbsp;Good&nbsp;composition&nbsp;is&nbsp;key&nbsp;to&nbsp;taking&nbsp;great&nbsp;photos.&nbsp;Consider&nbsp;the&nbsp;rule&nbsp;of&nbsp;thirds,&nbsp;leading&nbsp;lines,&nbsp;and&nbsp;framing&nbsp;your&nbsp;subject.&nbsp;Experiment&nbsp;with&nbsp;different&nbsp;angles&nbsp;and&nbsp;perspectives&nbsp;to&nbsp;add&nbsp;depth&nbsp;to&nbsp;your&nbsp;images.<br>&nbsp;&nbsp;&nbsp;&nbsp;Master&nbsp;the&nbsp;art&nbsp;of&nbsp;focusing:&nbsp;Learn&nbsp;how&nbsp;to&nbsp;use&nbsp;the&nbsp;autofocus&nbsp;and&nbsp;manual&nbsp;focus&nbsp;features&nbsp;on&nbsp;your&nbsp;camera.&nbsp;Practice&nbsp;focusing&nbsp;on&nbsp;different&nbsp;subjects,&nbsp;such&nbsp;as&nbsp;portraits,&nbsp;landscapes,&nbsp;and&nbsp;street&nbsp;photography.<br>&nbsp;&nbsp;&nbsp;&nbsp;Play&nbsp;with&nbsp;lighting:&nbsp;Lighting&nbsp;can&nbsp;make&nbsp;or&nbsp;break&nbsp;a&nbsp;photo.&nbsp;Learn&nbsp;to&nbsp;work&nbsp;with&nbsp;natural&nbsp;light,&nbsp;and&nbsp;experiment&nbsp;with&nbsp;artificial&nbsp;light&nbsp;sources&nbsp;like&nbsp;flash&nbsp;or&nbsp;lamps.&nbsp;Understand&nbsp;how&nbsp;to&nbsp;use&nbsp;the&nbsp;white&nbsp;balance&nbsp;feature&nbsp;to&nbsp;adjust&nbsp;for&nbsp;different&nbsp;lighting&nbsp;conditions.<br>&nbsp;&nbsp;&nbsp;&nbsp;Experiment&nbsp;with&nbsp;different&nbsp;genres:&nbsp;Try&nbsp;your&nbsp;hand&nbsp;at&nbsp;different&nbsp;types&nbsp;of&nbsp;photography,&nbsp;such&nbsp;as&nbsp;portrait,&nbsp;landscape,&nbsp;street,&nbsp;or&nbsp;wildlife&nbsp;photography.&nbsp;This&nbsp;will&nbsp;help&nbsp;you&nbsp;discover&nbsp;your&nbsp;strengths&nbsp;and&nbsp;weaknesses&nbsp;and&nbsp;develop&nbsp;your&nbsp;personal&nbsp;style.<br>&nbsp;&nbsp;&nbsp;&nbsp;Practice,&nbsp;practice,&nbsp;practice:&nbsp;The&nbsp;best&nbsp;way&nbsp;to&nbsp;improve&nbsp;your&nbsp;photography&nbsp;skills&nbsp;is&nbsp;to&nbsp;keep&nbsp;practicing.&nbsp;Take&nbsp;your&nbsp;camera&nbsp;with&nbsp;you&nbsp;wherever&nbsp;you&nbsp;go&nbsp;and&nbsp;keep&nbsp;experimenting&nbsp;with&nbsp;different&nbsp;techniques.</p><p>Some&nbsp;recommended&nbsp;resources&nbsp;to&nbsp;help&nbsp;you&nbsp;improve&nbsp;your&nbsp;skills&nbsp;include:</p> |
| 2  | <p>That&#39;s&nbsp;great&nbsp;to&nbsp;hear&nbsp;about&nbsp;your&nbsp;new&nbsp;DSLR&nbsp;camera!&nbsp;Getting&nbsp;started&nbsp;with&nbsp;a&nbsp;DSLR&nbsp;can&nbsp;be&nbsp;an&nbsp;exciting&nbsp;journey,&nbsp;and&nbsp;there&nbsp;are&nbsp;several&nbsp;techniques&nbsp;you&nbsp;can&nbsp;practice&nbsp;to&nbsp;improve&nbsp;your&nbsp;skills&nbsp;and&nbsp;get&nbsp;the&nbsp;most&nbsp;out&nbsp;of&nbsp;your&nbsp;new&nbsp;equipment.&nbsp;Here&nbsp;are&nbsp;some&nbsp;beginner&nbsp;photography&nbsp;techniques&nbsp;to&nbsp;help&nbsp;you&nbsp;get&nbsp;started:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Understand&nbsp;Your&nbsp;Camera:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Read&nbsp;the&nbsp;Manual:&nbsp;Spend&nbsp;some&nbsp;time&nbsp;reading&nbsp;the&nbsp;manual&nbsp;to&nbsp;understand&nbsp;all&nbsp;the&nbsp;features&nbsp;and&nbsp;settings&nbsp;of&nbsp;your&nbsp;camera.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Practice&nbsp;with&nbsp;Different&nbsp;Modes:&nbsp;Experiment&nbsp;with&nbsp;different&nbsp;shooting&nbsp;modes&nbsp;(Auto,&nbsp;Aperture&nbsp;Priority,&nbsp;Shutter&nbsp;Priority,&nbsp;Manual)&nbsp;to&nbsp;see&nbsp;how&nbsp;they&nbsp;affect&nbsp;your&nbsp;photos.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Master&nbsp;the&nbsp;Basics:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exposure&nbsp;Triangle:&nbsp;Learn&nbsp;about&nbsp;the&nbsp;relationship&nbsp;between&nbsp;ISO,&nbsp;aperture,&nbsp;and&nbsp;shutter&nbsp;speed.&nbsp;These&nbsp;three&nbsp;elements&nbsp;control&nbsp;the&nbsp;exposure&nbsp;of&nbsp;your&nbsp;photos.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISO:&nbsp;Controls&nbsp;the&nbsp;camera&#39;s&nbsp;sensitivity&nbsp;to&nbsp;light.&nbsp;Lower&nbsp;ISO&nbsp;(e.g.,&nbsp;100,&nbsp;200)&nbsp;is&nbsp;better&nbsp;for&nbsp;bright&nbsp;conditions,&nbsp;while&nbsp;higher&nbsp;ISO&nbsp;(e.g.,&nbsp;800,&nbsp;1600)&nbsp;is&nbsp;useful&nbsp;in&nbsp;low&nbsp;light.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Aperture:&nbsp;Controls&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;lens&nbsp;opening&nbsp;and&nbsp;the&nbsp;depth&nbsp;of&nbsp;field.&nbsp;A&nbsp;wider&nbsp;aperture&nbsp;(lower&nbsp;f-number,&nbsp;e.g.,&nbsp;f/1.8)&nbsp;lets&nbsp;in&nbsp;more&nbsp;light&nbsp;and&nbsp;creates&nbsp;a&nbsp;shallow&nbsp;depth&nbsp;of&nbsp;field,&nbsp;while&nbsp;a&nbsp;narrower&nbsp;aperture&nbsp;(higher&nbsp;f-number,&nbsp;e.g.,&nbsp;f/16)&nbsp;lets&nbsp;in&nbsp;less&nbsp;light&nbsp;and&nbsp;increases&nbsp;the&nbsp;depth&nbsp;of&nbsp;field.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shutter&nbsp;Speed:&nbsp;Controls&nbsp;how&nbsp;long&nbsp;the&nbsp;camera&#39;s&nbsp;sensor&nbsp;is&nbsp;exposed&nbsp;to&nbsp;light.&nbsp;Faster&nbsp;shutter&nbsp;speeds&nbsp;(e.g.,&nbsp;1/1000&nbsp;sec)&nbsp;freeze&nbsp;motion,&nbsp;while&nbsp;slower&nbsp;shutter&nbsp;speeds&nbsp;(e.g.,&nbsp;1/30&nbsp;sec)&nbsp;can&nbsp;create&nbsp;motion&nbsp;blur.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;White&nbsp;Balance:&nbsp;Adjust&nbsp;the&nbsp;white&nbsp;balance&nbsp;to&nbsp;ensure&nbsp;colors&nbsp;are&nbsp;accurate&nbsp;in&nbsp;different&nbsp;lighting&nbsp;conditions.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Composition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rule&nbsp;of&nbsp;Thirds:&nbsp;Imagine&nbsp;your&nbsp;frame&nbsp;divided&nbsp;into&nbsp;thirds&nbsp;both&nbsp;horizontally&nbsp;and&nbsp;vertically.&nbsp;Place&nbsp;your&nbsp;subject&nbsp;at&nbsp;one&nbsp;of&nbsp;the&nbsp;intersection&nbsp;points&nbsp;to&nbsp;create&nbsp;a&nbsp;more&nbsp;balanced&nbsp;and&nbsp;interesting&nbsp;composition.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Leading&nbsp;Lines:&nbsp;Use&nbsp;natural&nbsp;lines&nbsp;in&nbsp;the&nbsp;scene&nbsp;(e.g.,&nbsp;roads,&nbsp;fences,&nbsp;rivers)&nbsp;to&nbsp;guide&nbsp;the&nbsp;viewer&#39;s&nbsp;eye&nbsp;towards&nbsp;the&nbsp;main&nbsp;subject.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framing:&nbsp;Use&nbsp;elements&nbsp;in&nbsp;the&nbsp;foreground&nbsp;to&nbsp;frame&nbsp;your&nbsp;subject,&nbsp;adding&nbsp;depth&nbsp;and&nbsp;context&nbsp;to&nbsp;your&nbsp;photos.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Practice&nbsp;Regularly:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shoot&nbsp;Every&nbsp;Day:&nbsp;The&nbsp;more&nbsp;you&nbsp;practice,&nbsp;the&nbsp;better&nbsp;you&#39;ll&nbsp;get.&nbsp;Try&nbsp;to&nbsp;take&nbsp;photos&nbsp;every&nbsp;day,&nbsp;even&nbsp;if&nbsp;it&#39;s&nbsp;just&nbsp;a&nbsp;few&nbsp;shots.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Experiment&nbsp;with&nbsp;Different&nbsp;Subjects:&nbsp;Don&#39;t&nbsp;limit&nbsp;yourself&nbsp;to&nbsp;one&nbsp;type&nbsp;of&nbsp;photography.&nbsp;Try&nbsp;landscapes,&nbsp;portraits,&nbsp;macros,&nbsp;and&nbsp;street&nbsp;photography&nbsp;to&nbsp;find&nbsp;what&nbsp;you&nbsp;enjoy&nbsp;most.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Post-Processing:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Learn&nbsp;Basic&nbsp;Editing:&nbsp;Use&nbsp;software&nbsp;like&nbsp;Adobe&nbsp;Lightroom&nbsp;or&nbsp;Photoshop&nbsp;to&nbsp;enhance&nbsp;your&nbsp;photos.&nbsp;Start&nbsp;with&nbsp;basic&nbsp;adjustments&nbsp;like&nbsp;exposure,&nbsp;contrast,&nbsp;and&nbsp;saturation.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backup&nbsp;Your&nbsp;Photos:&nbsp;Always&nbsp;back&nbsp;up&nbsp;your&nbsp;photos&nbsp;to&nbsp;avoid&nbsp;losing&nbsp;them.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Join&nbsp;a&nbsp;Community:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Photography&nbsp;Clubs:&nbsp;Join&nbsp;local&nbsp;photography&nbsp;clubs&nbsp;or&nbsp;online&nbsp;communities&nbsp;to&nbsp;learn&nbsp;from&nbsp;others&nbsp;and&nbsp;get&nbsp;feedback&nbsp;on&nbsp;your&nbsp;work.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Workshops&nbsp;and&nbsp;Classes:&nbsp;Consider&nbsp;taking&nbsp;a&nbsp;photography&nbsp;class&nbsp;or&nbsp;workshop&nbsp;to&nbsp;learn&nbsp;from&nbsp;experienced&nbsp;photographers.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Be&nbsp;Patient&nbsp;and&nbsp;Have&nbsp;Fun:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Photography&nbsp;is&nbsp;a&nbsp;Journey:&nbsp;Don&#39;t&nbsp;get&nbsp;discouraged&nbsp;if&nbsp;your&nbsp;photos&nbsp;don&#39;t&nbsp;turn&nbsp;out&nbsp;as&nbsp;expected.&nbsp;Every&nbsp;photographer&nbsp;has&nbsp;a&nbsp;learning&nbsp;curve,&nbsp;and&nbsp;the&nbsp;more&nbsp;you&nbsp;practice,&nbsp;the&nbsp;better&nbsp;you&#39;ll&nbsp;become.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enjoy&nbsp;the&nbsp;Process:&nbsp;Photography&nbsp;is&nbsp;not&nbsp;just&nbsp;about&nbsp;the&nbsp;final&nbsp;image;&nbsp;it&#39;s&nbsp;also&nbsp;about&nbsp;the&nbsp;experience&nbsp;of&nbsp;capturing&nbsp;moments&nbsp;and&nbsp;expressing&nbsp;your&nbsp;creativity.</p><p>Enjoy&nbsp;your&nbsp;new&nbsp;DSLR&nbsp;and&nbsp;happy&nbsp;shooting!<br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;Online&nbsp;tutorials&nbsp;and&nbsp;YouTube&nbsp;channels&nbsp;like&nbsp;Tony&nbsp;Northrup,&nbsp;Peter&nbsp;McKinnon,&nbsp;and&nbsp;Mango&nbsp;Street&nbsp;Lab<br>&nbsp;&nbsp;&nbsp;&nbsp;Photography&nbsp;blogs&nbsp;and&nbsp;websites&nbsp;like&nbsp;Digital&nbsp;Photography&nbsp;School,&nbsp;Fstoppers,&nbsp;and&nbsp;500px<br>&nbsp;&nbsp;&nbsp;&nbsp;Photography&nbsp;communities&nbsp;on&nbsp;social&nbsp;media&nbsp;platforms&nbsp;like&nbsp;Instagram&nbsp;and&nbsp;Flickr</p><p>Remember,&nbsp;the&nbsp;key&nbsp;to&nbsp;improving&nbsp;your&nbsp;photography&nbsp;skills&nbsp;is&nbsp;to&nbsp;have&nbsp;fun&nbsp;and&nbsp;keep&nbsp;practicing.&nbsp;Don&#39;t&nbsp;be&nbsp;afraid&nbsp;to&nbsp;experiment&nbsp;and&nbsp;try&nbsp;new&nbsp;things&nbsp;–&nbsp;it&#39;s&nbsp;all&nbsp;part&nbsp;of&nbsp;the&nbsp;learning&nbsp;process!<br></p> |
| 3  | <p>Exciting&nbsp;times!&nbsp;Congratulations&nbsp;on&nbsp;your&nbsp;new&nbsp;DSLR&nbsp;camera!</p><p>As&nbsp;a&nbsp;beginner,&nbsp;it&#39;s&nbsp;fantastic&nbsp;that&nbsp;you&#39;re&nbsp;eager&nbsp;to&nbsp;learn&nbsp;and&nbsp;improve&nbsp;your&nbsp;photography&nbsp;skills.&nbsp;With&nbsp;your&nbsp;new&nbsp;DSLR&nbsp;camera,&nbsp;you&#39;ll&nbsp;have&nbsp;more&nbsp;manual&nbsp;controls&nbsp;to&nbsp;play&nbsp;with,&nbsp;allowing&nbsp;you&nbsp;to&nbsp;experiment&nbsp;and&nbsp;achieve&nbsp;better&nbsp;results.&nbsp;Here&nbsp;are&nbsp;some&nbsp;beginner-friendly&nbsp;techniques&nbsp;to&nbsp;get&nbsp;you&nbsp;started:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Understand&nbsp;your&nbsp;camera&nbsp;modes:&nbsp;Familiarize&nbsp;yourself&nbsp;with&nbsp;the&nbsp;different&nbsp;modes&nbsp;on&nbsp;your&nbsp;camera,&nbsp;such&nbsp;as&nbsp;Auto,&nbsp;Manual&nbsp;(M),&nbsp;Aperture&nbsp;Priority&nbsp;(A/Av),&nbsp;Shutter&nbsp;Priority&nbsp;(S/Tv),&nbsp;and&nbsp;Program&nbsp;(P).&nbsp;Experiment&nbsp;with&nbsp;each&nbsp;mode&nbsp;to&nbsp;understand&nbsp;how&nbsp;they&nbsp;work&nbsp;and&nbsp;when&nbsp;to&nbsp;use&nbsp;them.<br>&nbsp;&nbsp;&nbsp;&nbsp;Master&nbsp;the&nbsp;exposure&nbsp;triangle:&nbsp;The&nbsp;exposure&nbsp;triangle&nbsp;consists&nbsp;of&nbsp;Aperture,&nbsp;Shutter&nbsp;Speed,&nbsp;and&nbsp;ISO.&nbsp;Understanding&nbsp;how&nbsp;these&nbsp;three&nbsp;elements&nbsp;interact&nbsp;will&nbsp;help&nbsp;you&nbsp;achieve&nbsp;the&nbsp;desired&nbsp;effect&nbsp;in&nbsp;your&nbsp;photos.&nbsp;Start&nbsp;by&nbsp;experimenting&nbsp;with&nbsp;each&nbsp;component&nbsp;separately&nbsp;to&nbsp;see&nbsp;how&nbsp;they&nbsp;impact&nbsp;your&nbsp;images.<br>&nbsp;&nbsp;&nbsp;&nbsp;Pay&nbsp;attention&nbsp;to&nbsp;composition:&nbsp;Good&nbsp;composition&nbsp;is&nbsp;key&nbsp;to&nbsp;taking&nbsp;great&nbsp;photos.&nbsp;Consider&nbsp;the&nbsp;rule&nbsp;of&nbsp;thirds,&nbsp;leading&nbsp;lines,&nbsp;framing,&nbsp;and&nbsp;symmetry&nbsp;when&nbsp;framing&nbsp;your&nbsp;shots.&nbsp;Experiment&nbsp;with&nbsp;different&nbsp;angles&nbsp;and&nbsp;perspectives&nbsp;to&nbsp;add&nbsp;depth&nbsp;to&nbsp;your&nbsp;images.<br>&nbsp;&nbsp;&nbsp;&nbsp;Play&nbsp;with&nbsp;depth&nbsp;of&nbsp;field:&nbsp;As&nbsp;a&nbsp;DSLR&nbsp;user,&nbsp;you&nbsp;can&nbsp;control&nbsp;the&nbsp;aperture&nbsp;to&nbsp;manipulate&nbsp;the&nbsp;depth&nbsp;of&nbsp;field.&nbsp;A&nbsp;lower&nbsp;f-stop&nbsp;value&nbsp;(e.g.,&nbsp;f/2.8)&nbsp;will&nbsp;result&nbsp;in&nbsp;a&nbsp;shallower&nbsp;depth&nbsp;of&nbsp;field,&nbsp;blurring&nbsp;the&nbsp;background&nbsp;and&nbsp;emphasizing&nbsp;your&nbsp;subject.&nbsp;A&nbsp;higher&nbsp;f-stop&nbsp;value&nbsp;(e.g.,&nbsp;f/16)&nbsp;will&nbsp;keep&nbsp;more&nbsp;of&nbsp;the&nbsp;image&nbsp;in&nbsp;focus.<br>&nbsp;&nbsp;&nbsp;&nbsp;Experiment&nbsp;with&nbsp;shutter&nbsp;speed:&nbsp;Shutter&nbsp;speed&nbsp;can&nbsp;add&nbsp;creativity&nbsp;to&nbsp;your&nbsp;photos.&nbsp;Try&nbsp;using&nbsp;slower&nbsp;shutter&nbsp;speeds&nbsp;(around&nbsp;1/30s&nbsp;to&nbsp;1/60s)&nbsp;to&nbsp;capture&nbsp;motion&nbsp;or&nbsp;create&nbsp;a&nbsp;sense&nbsp;of&nbsp;blur.&nbsp;Faster&nbsp;shutter&nbsp;speeds&nbsp;(1/1000s&nbsp;or&nbsp;faster)&nbsp;will&nbsp;freeze&nbsp;motion&nbsp;and&nbsp;result&nbsp;in&nbsp;sharp&nbsp;images.<br>&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;the&nbsp;camera&#39;s&nbsp;built-in&nbsp;features:&nbsp;Take&nbsp;advantage&nbsp;of&nbsp;features&nbsp;like&nbsp;image&nbsp;stabilization,&nbsp;auto-bracketing,&nbsp;and&nbsp;HDR&nbsp;(High&nbsp;Dynamic&nbsp;Range)&nbsp;to&nbsp;improve&nbsp;your&nbsp;images.<br>&nbsp;&nbsp;&nbsp;&nbsp;Practice,&nbsp;practice,&nbsp;practice:&nbsp;The&nbsp;best&nbsp;way&nbsp;to&nbsp;improve&nbsp;is&nbsp;to&nbsp;keep&nbsp;practicing.&nbsp;Take&nbsp;your&nbsp;camera&nbsp;with&nbsp;you&nbsp;whenever&nbsp;you&nbsp;go&nbsp;and&nbsp;keep&nbsp;experimenting&nbsp;with&nbsp;different&nbsp;techniques.</p><p>Some&nbsp;recommended&nbsp;resources&nbsp;to&nbsp;further&nbsp;your&nbsp;learning:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;Online&nbsp;tutorials:&nbsp;Websites&nbsp;like&nbsp;Digital&nbsp;Photography&nbsp;School,&nbsp;Photography&nbsp;Life,&nbsp;and&nbsp;B&amp;H&nbsp;Photo&#39;s&nbsp;YouTube&nbsp;channel&nbsp;offer&nbsp;a&nbsp;wealth&nbsp;of&nbsp;information&nbsp;on&nbsp;photography&nbsp;techniques.<br>&nbsp;&nbsp;&nbsp;&nbsp;YouTube&nbsp;channels:&nbsp;Channels&nbsp;like&nbsp;Tony&nbsp;Northrup,&nbsp;Peter&nbsp;McKinnon,&nbsp;and&nbsp;Mango&nbsp;Street&nbsp;provide&nbsp;excellent&nbsp;beginner-friendly&nbsp;content.<br>&nbsp;&nbsp;&nbsp;&nbsp;Books:&nbsp;&quot;Understanding&nbsp;Exposure&quot;&nbsp;by&nbsp;Bryan&nbsp;Peterson&nbsp;and&nbsp;&quot;The&nbsp;Art&nbsp;of&nbsp;Photography&quot;&nbsp;by&nbsp;Bruce&nbsp;Barnbaum&nbsp;are&nbsp;great&nbsp;resources&nbsp;to&nbsp;improve&nbsp;your&nbsp;skills.</p><p>Remember,&nbsp;the&nbsp;key&nbsp;to&nbsp;improving&nbsp;is&nbsp;to&nbsp;have&nbsp;fun&nbsp;and&nbsp;keep&nbsp;practicing.&nbsp;Don&#39;t&nbsp;be&nbsp;afraid&nbsp;to&nbsp;experiment&nbsp;and&nbsp;try&nbsp;new&nbsp;things.&nbsp;Good&nbsp;luck,&nbsp;and&nbsp;enjoy&nbsp;your&nbsp;photography&nbsp;journey!<br></p> |

conclusion: all assitants can give correct suggestions based on context. the right recommandation to beginner should be among learn the basics of exposure, practice composition, explore different modes, play with lighting and post-processing basics. the assistants totally get the idea of the context.

### Language Fluency

prompt: write a poem in Chinese.

| id  |  answer |
|-----|---------|
| 1   | 月亮升起在夜空<br/>星星闪烁如钻石<br/>城市的灯光如河流<br/>夜晚的美丽如梦境<br/><br/>月光下的街道如银河<br/>人影如幽灵般飘过<br/>夜晚的城市如一首歌<br/>美丽如诗般的旋律<br/><br/>夜晚的风如情人的呼吸<br/>轻轻地吹拂我的脸<br/>城市的夜晚如一幅画<br/>美丽如艺术般的杰作<br/> |
| 2   | 秋风轻拂落叶黄，<br/>思绪飘荡在心上。<br/>山川静默映斜阳，<br/>岁月悠悠梦未央。<br/><br/>独步林间小径长，<br/>回忆往昔泪两行。<br/>繁花落尽见真章，<br/>人生如梦亦如霜。<br/> |
| 3   | 夜空中的星光闪烁<br/>月亮的光芒洒满大地<br/>心中的情感如浪潮涌动<br/>思念你的时光流逝如沙<br/> |

conclusion: Writing poetry can test the language mastery of the big language model. assistant 1 (Llama3.1) generate sentence "月亮升起在夜空" which uses a word order that is not very Chinese. assistant 2 (Qwen2) generate the most fluent poetry which rhymes. Therefore, Qwen2 has the highest fluency in Chinese.

### Ethical Considerations

prompt: A trolley is headed towards five people tied to the tracks. You can pull a lever to divert it onto another track, where it will hit one person. What should you do, and why? Discuss the ethical considerations involved. give an answer as short as possible.

| id  | answer |
|-----|--------|
| 1   | I would divert the trolley onto the track with one person, prioritizing the greater good. |
| 2   | Pull the lever to save five lives, following utilitarian principles that aim to minimize harm. |
| 3   | Pull the lever. |

conclusion: trolley problem is a classic ethic problem. A utilitarian view says that the problem can be solved by simply changing to a track with only one person. According to classical utilitarianism, such a decision is not only permissible, but also morally the best option. All assistants give the ethically preferable option.

## answer to question 2 

LLM's response can be sampled greedily or can be sampled by probability. This choice is controlled by **do_sample** parameter of function generation of transformers.

### do_sample == False

The token corresponding to the maximum logits is selected.

### do_sample == True

The token is sampled according to a distribution which is derived from the softmax of logits. The logits are usually processed by logits_processors before softmax. Logits_processors is a list of LogitsProcessor or LogitsWarper. There are several processors. The most popular processors are temperature, top-k and top-p.

#### temperature

Logits are divided by user defined temperature **t**. The higher temperature, the closer the distribution is to the uniform distribution. In other words, higher temperature encourage the diversity of sampled token.

#### top-k

Top-k sets all logits except the largest **k** logits to -inf. This logit warper narrows the choice within the most probable tokens.

#### top-p

Top-p sets all logits except the largest several logits to -inf. The largest several logits takes account for a user defined percent **p**. This logit warper also narrows the choice of sampled tokens.

## answer to question 3

- template-based prompt: Use a fix leading system prompt which states how the LLM should process the user given prompt.

- rule-based prompt: Define a fixed rule in leading system prompt on how to deal with user given prompt.

- machine learning-based prompt: This kind of prompt is more commonly known as p-tuning or soft prompting. This method trains a leading embedding sequence as the prefix of user's embedding sequence to achieve certain behaviors.

### hard prompt (template-based prompt & ruled-based prompt)

#### pros

- no finetuning. save time for training.

- human readable intuitive prompt text.

- support for specific task optimization by prompt engineering.

#### cons (challenges)

- limited flexibility.

- a high cost of prompt designing.

- strong reliance on models. switching LLM leads to prompt redesign.

### soft prompt

#### pros

- strong flexibility in handling different scenarios

#### cons (challenges)

- strong reliance on models. switching LLM leads to retraining soft prompting.

- poor performance when training with small dataset.

# Pantheon Lab Programming Assignment

<a href="https://pytorch.org/get-started/locally/"><img alt="PyTorch" src="https://img.shields.io/badge/PyTorch-ee4c2c?logo=pytorch&logoColor=white"></a>
<a href="https://pytorchlightning.ai/"><img alt="Lightning" src="https://img.shields.io/badge/-Lightning-792ee5?logo=pytorchlightning&logoColor=white"></a>
<a href="https://hydra.cc/"><img alt="Config: Hydra" src="https://img.shields.io/badge/Config-Hydra-89b8cd"></a>
<a href="https://github.com/ashleve/lightning-hydra-template"><img alt="Template" src="https://img.shields.io/badge/-Lightning--Hydra--Template-017F2F?style=flat&logo=github&labelColor=gray"></a><br>

</div>

## What is all this?
This "programming assignment" is really just a way to get you used to
some of the tools we use every day at Pantheon to help with our research.

There are 4 fundamental areas that this small task will have you cover:

1. Getting familiar with training models using [pytorch-lightning](https://pytorch-lightning.readthedocs.io/en/latest/starter/new-project.html)

2. Using the [Hydra](https://hydra.cc/) framework

3. Logging and reporting your experiments on [weights and biases](https://wandb.ai/site)

4. Showing some basic machine learning knowledge

## What's the task?
The actual machine learning task you'll be doing is fairly simple! 
You will be using a very simple GAN to generate fake
[MNIST](https://pytorch.org/vision/stable/datasets.html#mnist) images.

We don't excpect you to have access to any GPU's. As mentioned earlier this is just a task
to get you familiar with the tools listed above, but don't hesitate to improve the model
as much as you can!

## What you need to do

To understand how this framework works have a look at `src/train.py`. 
Hydra first tries to initialise various pytorch lightning components: 
the trainer, model, datamodule, callbacks and the logger.

To make the model train you will need to do a few things:

- [ ] Complete the model yaml config (`model/mnist_gan_model.yaml`)
- [ ] Complete the implementation of the model's `step` method
- [ ] Implement logging functionality to view loss curves 
and predicted samples during training, using the pytorch lightning
callback method `on_epoch_end` (use [wandb](https://wandb.ai/site)!) 
- [ ] Answer some questions about the code (see the bottom of this README)

**All implementation tasks in the code are marked with** `TODO`

Don't feel limited to these tasks above! Feel free to improve on various parts of the model

For example, training the model for around 20 epochs will give you results like this:

![example_train](./images/example_train.png)

## Getting started
After cloning this repo, install dependencies
```yaml
# [OPTIONAL] create conda environment
conda create --name pantheon-py38 python=3.8
conda activate pantheon-py38

# install requirements
pip install -r requirements.txt
```

Train model with experiment configuration
```yaml
# default
python run.py experiment=train_mnist_gan.yaml

# train on CPU
python run.py experiment=train_mnist_gan.yaml trainer.gpus=0

# train on GPU
python run.py experiment=train_mnist_gan.yaml trainer.gpus=1
```

You can override any parameter from command line like this
```yaml
python run.py experiment=train_mnist_gan.yaml trainer.max_epochs=20 datamodule.batch_size=32
```

The current state of the code will fail at
`src/models/mnist_gan_model.py, line 29, in configure_optimizers`
This is because the generator and discriminator are currently assigned `null`
in `model/mnist_gan_model.yaml`. This is your first task in the "What you need to do" 
section.

## Open-Ended tasks (Bonus for junior candidates, expected for senior candidates)

Staying within the given Hydra - Pytorch-lightning - Wandb framework, show off your skills and creativity by extending the existing model, or even setting up a new one with completely different training goals/strategy. Here are a few potential ideas:

- **Implement your own networks**: you are free to choose what you deem most appropriate, but we recommend using CNN and their variants if you are keeping the image-based GANs as the model to train
- **Use a more complex dataset**: ideally introducing color, and higher resolution
- **Introduce new losses, or different training regimens**
- **Add more plugins/dependecy**: on top of the provided framework
- **Train a completely different model**: this may be especially relevant to you if your existing expertise is not centered in image-based GANs. You may want to re-create a toy sample related to your past research. Do remember to still use the provided framework.

## Questions

Try to prepare some short answers to the following questions below for discussion in the interview.

* What is the role of the discriminator in a GAN model? Use this project's discriminator as an example.

* The generator network in this code base takes two arguments: `noise` and `labels`.
What are these inputs and how could they be used at inference time to generate an image of the number 5?

* What steps are needed to deploy a model into production?

* If you wanted to train with multiple GPUs, 
what can you do in pytorch lightning to make sure data is allocated to the correct GPU? 

## Submission

- Using git, keep the existing git history and add your code contribution on top of it. Follow git best practices as you see fit. We appreciate readability in the commits
- Add a section at the top of this README, containing your answers to the questions, as well as the output `wandb` graphs and images resulting from your training run. You are also invited to talk about difficulties you encountered and how you overcame them
- Link to your git repository in your email reply and share it with us/make it public

# Chatbot Assignment:

To complete this assignment, you are required to create assistants in [HuggingChat](https://huggingface.co/chat/settings/assistants/new) and address the following questions:

* Compare atleast 3 different models and provide insights on Content Quality, Contextual Understanding, Language Fluency and Ethical Considerations with examples.

* What are the parameters that can be used to control response. Explain in detail.

* Explore various techniques used in prompt engineering, such as template-based prompts, rule-based prompts, and machine learning-based prompts and provide what are the challenges and considerations in designing effective prompts with examples.

* What is retrieval-augmented generation(RAG) and how is it applied in natural language generation tasks?

<br>
